- category = Category.find_by_name( params[:choices].present? ? params[:choices] : current_tenant.default_category)
- @choice ||= ( @meal.present? || @cart.present?) ? category.children.first : Category.find_by_name( params[:id] )
- @page = Page.find_by_code( @choice.name )
%ul#catalogue
  - if @page
    != render 'pages/show_short'
  - subcats = params[:filter].present? ? @choice.children.where( name: params[:filter]) : @choice.children
  - subcats.each do |subcat|
    - unless !(allow? :items, :create) && subcat.items.size == 0
      %li
        %p.header
          %span.title
            != subcat.nice_name.pluralize
          - if allow? :items, :create
            %td= link_to 'New', new_item_path( category_id: subcat.id)

            !=# @choice.name.titleize.pluralize
          %span.notes
            != subcat.description unless subcat.description.blank?
        = render :partial => "choices/#{current_tenant.domain}/show", locals: { subcat: subcat}

:coffeescript
  jQuery ->
    $('a.gallery').colorbox(
     {
       current: ""
     }
    )
