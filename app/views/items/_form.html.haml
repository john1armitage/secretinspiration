- @categories = get_categories( params[:root_category] || @item.category.root.name )         #  @categories = get_categories( )

= form_for @item, :validate => true, :class => "no_ajaxify"  do |f|
  %fieldset
    %legend= 'Item: ' + ( @item.name || "new" )
    = hidden_field_tag :root_category, params[:root_category]
    .row
      .field.small-4.columns
        = f.label :name
        = f.text_field :name
      .field.small-1.columns
        = f.label :rank
        = f.text_field :rank

      .field.small-2.columns.left
        = f.label :product_flow
        = collection_select(:item, :product_flow,
          Element.where("kind = 'product_flow'").order(:rank), :name, :name, include_blank: true)
      .field.small-4.columns
        = f.label :category, 'Category'
        = f.grouped_collection_select :category_id, @categories, :categories, :nice_name, :id, :nice_name,
          :include_blank => true
    .row
      .field.small-2.columns
        = f.label :price
        = f.text_field :price
      .field.small-2.columns.left
        = f.label :vat_rate
        = collection_select(:item, :vat_rate,
          Element.where("kind = 'vat_rate'").order(:rank), :name, :name, include_blank: true)
      .field.small-3.columns.left
        = f.label :sups, 'Suppliers'
        = f.collection_select :sups, get_suppliers( @item.category_id), 'id', 'name', {}, {:multiple => true}
        - p "CATS"
        - p @item.category_id
        - p "CATS 2"
        - p get_suppliers( @item.category_id)
    .row
      .field.small-8.columns
        = f.label :description
        = f.text_area :description
    .row
      .field.small-8.columns
        = f.label :slug
        = f.text_field :slug

    .row
      .actions
        = f.submit 'Save'
