- hours = 0.00
- wages = 0.00
- tips = 0.00
- week_hours = 0.00
- week_wages = 0.00
- week_tips = 0.00
- if @timesheets.size > 0
  - timesheet_date = @timesheets.first.work_date
  - week = week_number(timesheet_date) #.to_date.strftime('%U')
  - hmrc_pay_week = HMRC_week_number(timesheet_date.beginning_of_week + 12.days)
  - week_start = week_start(timesheet_date)
  - employee = @timesheets.first.employee.name
#summary
  .row
    .field.large-12.columns.title
      = "W/b #{week_start} (HMRC #{hmrc_pay_week})"
  - if @timesheets.size > 0
    .row
      .large-12.columns.head
        = employee
    - @timesheets.each do |timesheet|
      - hours += timesheet.hours
      - wage = timesheet.pay.to_d
      - tip = ((timesheet.tips || 0.00 )/ 100.00 / timesheet.headcount.to_d)
      - tips += tip
      - wages += wage

      - if employee != timesheet.employee.name
        .row.title
          .field.large-12.columns.sub.head
            WEEK TOTAL
        .row.title
          .field.large-3.columns.sub
            Hours
          .field.large-5.columns.number.sub
            Pay
          .field.large-4.columns.number.sub
            Tips
        .row
          .field.large-3.columns.sub
            = week_hours
          .field.large-5.columns.number.sub
            = pounds(week_wages)
          .field.large-4.columns.number.sub
            = pounds(week_tips)
        .row
          .large-12.columns.head
            = timesheet.employee.name
        - week = week_number(timesheet.work_date) #.to_date.strftime('%U')
        - hmrc_pay_week = HMRC_week_number(timesheet.work_date.beginning_of_week + 12.days)
        - week_start = week_start(timesheet.work_date)
        - week_hours = 0.00
        - week_wages = 0.00
        - week_tips = 0.00
        - employee = timesheet.employee.name
      - week_hours += timesheet.hours
      - week_wages += wage
      - week_tips += tip
      .row
        .field.large-12.columns.id
          = "#{timesheet.work_date.strftime('%a')}, #{timesheet.work_date.strftime('%e').to_i.ordinalize} #{timesheet.work_date.strftime('%B')}"
          = "#{timesheet.session}" unless timesheet.session == 'dinner'
      .row.title
        .field.large-3.columns
          Hours
        .field.large-5.columns.number
          Pay
        .field.large-4.columns.number
          Tips
      .row
        .field.large-3.columns
          = timesheet.hours
        .field.large-5.columns.number
          = "#{pounds(wage)}"
        .field.large-4.columns.number
          = "#{pounds(tip)}"
    .row
      .large-12.columns.sub.head
        Total
    .row.title
      .field.large-3.columns.sub
        Hours
      .field.large-5.columns.number.sub
        Pay
      .field.large-4.columns.number.sub
        Tips
    .row
      .field.large-3.columns.sub
        = week_hours
      .field.large-5.columns.number.sub
        = pounds(week_wages)
      .field.large-4.columns.number.sub
        = pounds(week_tips)
